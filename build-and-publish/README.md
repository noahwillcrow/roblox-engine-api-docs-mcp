# Build and Publish Scripts

This directory contains scripts to automate the process of building and publishing the Docker image for the Roblox Engine API Docs MCP Server. The process is now split into two main scripts: `ingest-locally` and `go`.

## `ingest-locally` Script

This script runs the data ingestion process on your local machine, creating the `qdrant_data` directory. This directory contains the vector database and is required by the main application.

### Prerequisites

*   Python 3.11 and Poetry installed.

### Usage

Run this script from the project root directory whenever you need to update the API data:

```bash
./build-and-publish/ingest-locally
```

## `go` Script

The `go` script builds the main application Docker image and pushes it to a container registry. It assumes that the `qdrant_data` directory has already been generated by the `ingest-locally` script.

### Prerequisites

*   Docker Desktop (or Docker Engine) installed and running.
*   Docker Buildx installed and configured.
*   A Docker Hub account (or access to another container registry).
*   The `qdrant_data` directory must exist. Run `./build-and-publish/ingest-locally` first.

### Usage

To run the script, navigate to the project root directory and execute the following command:

```bash
./build-and-publish/go DOCKERHUB_USERNAME [DOCKERHUB_PASSWORD_OR_PAT] [--force-ingestion]
```

#### Arguments

*   `DOCKERHUB_USERNAME`: (Required) Your Docker Hub username.
*   `DOCKERHUB_PASSWORD_OR_PAT`: (Optional) Your Docker Hub password or a Personal Access Token (PAT). If you do not provide this argument, you will be prompted to enter your password interactively.
*   `--force-ingestion`: (Optional) If provided, the script will delete the existing `qdrant_data` directory and run the `ingest-locally` script to regenerate it before building the main image.

### What the `go` Script Does

1.  **Checks for `qdrant_data`**: It verifies that the `qdrant_data` directory exists.
2.  **Logs in to Docker Hub**: It authenticates you with Docker Hub using the provided credentials.
3.  **Gets the Roblox API Version**: It runs a script to fetch the latest Roblox API version, which is used to tag the Docker image.
4.  **Builds and Pushes the MCP Server Docker Image**: It builds the `roblox-engine-api-docs-mcp-server` Docker image for `linux/amd64` and `linux/arm64` platforms, copying the local `qdrant_data` directory into the image. It then pushes both `latest` and version-specific tags to your Docker Hub repository.

This two-step process separates the time-consuming data ingestion from the image build, resulting in a much faster development workflow.